# Key binding for running a command in the right pane.
bind . send-keys -t right "python run.py" Enter

# remap prefix from 'C-b' to 'C-x'
unbind C-b
set-option -g prefix C-x
bind-key C-x send-prefix

# Set fish shell.
if-shell "uname | grep -q Linux" "set -g default-command /usr/bin/fish"
if-shell "uname | grep -q Linux" "set -g default-shell /usr/bin/fish"
if-shell "uname | grep -q Darwin" "set -g default-command /opt/homebrew/bin/fish;"
if-shell "uname | grep -q Darwin" "set -g default-shell /opt/homebrew/bin/fish"

# start with window 1 (instead of 0)
set -g base-index 1

# Renumber windows when one gets deleted
set-option -g renumber-windows on

# start with pane 1
set -g pane-base-index 1

# split panes using | and -, make sure they open in the same path
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

unbind '"'
unbind %

# Open new windows in the current path
bind c new-window -c "#{pane_current_path}"

# Reload config file
bind r source-file ~/.tmux.conf

# Jump to previous window
unbind p
bind p previous-window

# shorten command delay
set -sg escape-time 1

# don't rename windows automatically
set -g allow-rename off

# mouse control (clickable windows, panes, resizable panes)
set -g mouse on

# vim-like pane switching
bind k select-pane -U 
bind j select-pane -D 
bind h select-pane -L 
bind l select-pane -R

# Make tmux quiet
set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
setw -g monitor-activity off
set -g bell-action none

# Statusbar location and color.
set -g status-position top
set -g status-justify left
set -g status-left ''
set -g status-right ''

# Setup some colours
setw -g clock-mode-colour colour5
set -g default-terminal "screen-256color"
# Magic command to make the colours work properly. 
set -ga terminal-overrides ",xterm-256color:Tc"
#Maybe needed on ubunut?set -g default-terminal "term-256color"
set -g allow-passthrough 1

# Increase scrollback buffer size from 2000 to 50000 lines
set -g history-limit 50000

# Increase tmux messages display duration from 750ms to 4s
set -g display-time 4000

# Emacs key bindings in tmux command prompt (prefix + :) are better than
# vi keys, even for vim users
set -g status-keys emacs

# Make copying to and from tmux nicer.
# Just copy when you drag over a section of text.
if-shell "uname | grep -q Darwin" "bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel 'pbcopy'"
if-shell "uname | grep -q Linux" "bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel"
# Use vi keybindings in copy mode.
setw -g mode-keys vi
# Use v in vi mode to start selection
bind -T copy-mode-vi v send -X begin-selection
# Use r to select rectangular regions.
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle
# Yank in copy mode to system clipboard. TODO: Need equivalent line for linux
if-shell "uname | grep -q Darwin" "bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'pbcopy'"

set -g status "on"
set -g status-justify "left"
# Remove the * from the active tmux window. The colour should be enough
set -g window-status-current-format "#I:#W "

# Required to get cpy-paste from a remote working
# See: https://github.com/ojroques/nvim-osc52 for more info
set -s set-clipboard on

# Bind a key to open my tmux config
bind e new-window -n "tmux-config" nvim ~/.tmux.conf

# Remap new-window key to first ask for a name
bind-key c command-prompt -p "window name:" "new-window; rename-window '%%'"

# Setup colours: Colours taken from the Kanagawa theme

# Status bar colours:
set -g status-bg '#181616'
set -g status-fg '#e0def4'
set -g status-style "fg=#2e7de9,bg=#e9e9ec"
# Activate tab text colour.
set-window-option -g window-status-current-style fg='#e0def4'
# Active tab background colour
set-window-option -g window-status-current-style bg='#363646'

# Set color for entering commands.
# Just make this the same as the bg and fg colours used for the status bar above
set -g message-style "fg=#e0def4,bg=#181616"
set -g message-command-style "fg=#e0def4,bg=#181616"

# copy mode highlight colours
# set-window-option -g mode-style "fg=#787c99,bg=#363646"
set-window-option -g mode-style "fg=#54546D,bg=#DCD7BA"

# Set pane border colours
set -g pane-border-style "fg=#1f1d2e"
set -g pane-active-border-style "fg=#7E9CD8"

# You can use the swap-pane command. By default this is bound to prefix { and prefix }
